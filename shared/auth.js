import{auth,db,onAuthStateChanged,setPersistence,browserLocalPersistence,doc,getDoc}from"./firebase.js";export async function requireLogin(n="/login.html"){await setPersistence(auth,browserLocalPersistence);return new Promise(e=>{onAuthStateChanged(auth,async t=>{if(!t){location.href=n;return}e(t)})})}export async function currentProfile(e){const t=await getDoc(doc(db,"users",e));return t.exists()?t.data():null}export async function requireAdmin(){const e=await requireLogin("/login.html"),t=await currentProfile(e.uid);if(!t||t.role!=="admin"){location.href="/dashboard.html";return null}return{user:e,profile:t}}